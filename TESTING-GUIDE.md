# 前端更新测试指南

## 前置条件

1. ✅ 后端服务运行在 http://localhost:3100
2. ✅ 数据库正常运行
3. ✅ 已修复数据清洗bug（errorSummary字段）

## 安装步骤

### 1. 安装新依赖

```bash
cd data-cleaning-frontend
pnpm add @radix-ui/react-tabs
```

### 2. 启动前端

```bash
pnpm dev
```

或者使用提供的脚本：

```powershell
.\install-and-test-frontend.ps1
```

## 测试流程

### 步骤 1: 上传测试文件

1. 打开浏览器访问 http://localhost:5173
2. 点击"上传文件"或进入上传页面
3. 选择测试文件: `testdoc/dirty_test_data.csv`
4. 点击上传并等待处理完成

**预期结果**:
- 文件上传成功
- 显示处理进度
- 处理完成后显示统计信息：
  - 总行数: 15
  - 清洁行数: 8
  - 异常行数: 7

### 步骤 2: 进入文件详情页面

1. 在文件列表中找到刚上传的文件
2. 点击文件名或"查看详情"按钮
3. 进入文件详情页面

**预期结果**:
- 显示文件基本信息
- 显示处理统计（绿色、橙色、蓝色三个卡片）
- 显示下载管理器
- **显示新的数据查看器组件**（在页面底部）

### 步骤 3: 测试清洁数据Tab

1. 默认应该显示"清洁数据"Tab
2. 检查Tab标签上的徽章数字（应该显示8）
3. 查看表格内容：
   - 应该显示行号列
   - 应该显示所有数据字段（姓名、手机号码、地址、入职日期）
   - 数据应该是清洗后的格式

**测试分页**:
- 如果数据超过50条，应该显示分页控件
- 点击"下一页"按钮
- 点击"上一页"按钮
- 检查页码显示是否正确

**测试下载**:
- 点击"下载清洁数据"按钮
- 应该下载一个Excel文件
- 打开Excel文件验证数据

**测试刷新**:
- 点击"刷新"按钮
- 数据应该重新加载

### 步骤 4: 测试异常数据Tab

1. 点击"异常数据"Tab
2. 检查Tab标签上的徽章数字（应该显示7）
3. 查看表格内容：
   - 应该显示行号列
   - 应该显示原始数据列（JSON格式）
   - 应该显示错误详情列（红色背景的错误卡片）

**检查错误详情**:
每个错误应该显示：
- 字段名（如"手机号码"、"地址"、"入职日期"）
- 错误消息（如"Invalid phone number format"）
- 原始值

**预期的7个异常行**:
1. 行2: 手机号码错误（138-1234-5678）
2. 行4: 日期错误（23/08/15）
3. 行5: 手机号码错误（139-123-45678）
4. 行8: 手机号码错误（1391234567890）
5. 行10: 手机号码+日期双重错误
6. 行11: 手机号码错误（13912345）
7. 行13: 地址错误（广东省广州市）
8. 行14: 地址错误（东路800号）

**测试分页**:
- 同清洁数据Tab

**测试下载**:
- 点击"下载异常数据"按钮（红色按钮）
- 应该下载一个Excel文件
- 打开Excel文件验证异常数据和错误信息

**测试刷新**:
- 点击"刷新"按钮
- 数据应该重新加载

### 步骤 5: 测试Tab切换

1. 在"清洁数据"和"异常数据"之间来回切换
2. 检查：
   - Tab切换流畅
   - 数据正确加载
   - 分页状态独立（切换Tab不影响另一个Tab的分页）
   - 下载按钮正确切换

### 步骤 6: 测试响应式设计

1. 调整浏览器窗口大小
2. 检查：
   - 表格支持横向滚动
   - 行号列固定在左侧
   - 布局在小屏幕上仍然可用

### 步骤 7: 测试空数据状态

1. 上传一个所有数据都正确的文件
2. 进入文件详情
3. 切换到"异常数据"Tab
4. 应该显示空状态提示：
   - 图标
   - "暂无异常数据"
   - "所有数据都已成功清洗"

## UI/UX 检查清单

### 视觉效果
- [ ] Tab切换有平滑过渡
- [ ] 表格行有悬停效果
- [ ] 按钮有悬停和点击效果
- [ ] 加载动画流畅
- [ ] 颜色主题一致（清洁数据=绿色，异常数据=红色/橙色）

### 交互体验
- [ ] Tab点击响应快速
- [ ] 分页切换流畅
- [ ] 下载功能正常
- [ ] 刷新功能正常
- [ ] 错误信息清晰易读

### 性能
- [ ] 首次加载速度快
- [ ] Tab切换无明显延迟
- [ ] 分页切换快速
- [ ] 大数据量时表格滚动流畅

## 常见问题排查

### 问题1: Tab组件不显示
**原因**: @radix-ui/react-tabs 未安装
**解决**: 运行 `pnpm add @radix-ui/react-tabs`

### 问题2: 数据不显示
**原因**: 后端API未运行或数据库连接失败
**解决**: 
1. 检查后端服务是否运行
2. 检查数据库是否正常
3. 查看浏览器控制台错误

### 问题3: 异常数据为0
**原因**: 后端bug未修复（errorSummary字段缺失）
**解决**: 确保已应用errorSummary字段的修复

### 问题4: 分页不工作
**原因**: API返回数据格式不正确
**解决**: 检查API响应格式是否包含 data, total, page, totalPages

### 问题5: 下载失败
**原因**: 后端导出服务异常
**解决**: 
1. 检查后端日志
2. 确保数据库中有数据
3. 检查文件导出路径权限

## 成功标准

✅ 所有测试步骤通过
✅ UI显示正常
✅ 交互流畅
✅ 数据准确
✅ 无控制台错误
✅ 下载功能正常

## 报告问题

如果发现问题，请提供：
1. 问题描述
2. 复现步骤
3. 浏览器控制台错误
4. 后端日志（如果相关）
5. 截图或录屏

## 下一步

测试通过后，可以：
1. 部署到测试环境
2. 进行用户验收测试
3. 收集用户反馈
4. 规划下一步功能改进
