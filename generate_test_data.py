import csv
import random
import time
from datetime import datetime, timedelta

# 姓氏列表
surnames = ['张', '李', '王', '赵', '钱', '孙', '周', '吴', '郑', '陈', '刘', '杨', '黄', '朱', '林', '何', '郭', '马', '罗', '梁']

# 名字列表
names = ['伟', '芳', '娜', '秀英', '敏', '静', '丽', '强', '磊', '军', '洋', '勇', '艳', '杰', '娟', '涛', '明', '超', '秀兰', '霞', '平', '刚', '桂英', '玉兰', '萍', '飞', '建', '红', '梅', '英', '华', '国', '文', '秀珍', '玲', '建国', '建军', '志强', '海燕', '桂兰', '玉珍', '春华', '建华', '桂芳', '秀梅', '春梅', '秀华', '志明', '玉华', '春兰', '秀英', '桂英', '玉英', '秀珍', '桂珍', '春霞', '秀兰', '玉梅', '秀云', '桂云', '春荣', '秀荣', '桂荣', '玉荣', '春华', '秀华', '桂华', '玉华', '春梅', '秀梅', '桂梅', '玉梅', '春兰', '秀兰', '桂兰', '玉兰', '春英', '秀英', '桂英', '玉英', '春珍', '秀珍', '桂珍', '玉珍', '春霞', '秀霞', '桂霞', '玉霞', '春云', '秀云', '桂云', '玉云', '春荣', '秀荣', '桂荣', '玉荣', '春华', '秀华', '桂华', '玉华', '春梅', '秀梅', '桂梅', '玉梅', '春兰', '秀兰', '桂兰', '玉兰', '春英', '秀英', '桂英', '玉英', '春珍', '秀珍', '桂珍', '玉珍', '春霞', '秀霞', '桂霞', '玉霞', '春云', '秀云', '桂云', '玉云', '春荣', '秀荣', '桂荣', '玉荣']

# 省份列表
provinces = ['北京市', '上海市', '广东省', '江苏省', '浙江省', '山东省', '河南省', '湖北省', '四川省', '湖南省', '河北省', '福建省', '陕西省', '辽宁省', '安徽省', '重庆市', '江西省', '天津市', '广西壮族自治区', '云南省', '贵州省', '山西省', '吉林省', '黑龙江省', '新疆维吾尔自治区', '甘肃省', '海南省', '宁夏回族自治区', '青海省', '西藏自治区']

# 城市列表
cities = {
    '北京市': ['朝阳区', '海淀区', '东城区', '西城区', '丰台区', '石景山区', '通州区', '顺义区', '大兴区', '昌平区'],
    '上海市': ['浦东新区', '黄浦区', '徐汇区', '长宁区', '静安区', '普陀区', '虹口区', '杨浦区', '闵行区', '宝山区'],
    '广东省': ['广州市', '深圳市', '珠海市', '汕头市', '佛山市', '韶关市', '湛江市', '肇庆市', '江门市', '茂名市'],
    '江苏省': ['南京市', '无锡市', '徐州市', '常州市', '苏州市', '南通市', '连云港市', '淮安市', '盐城市', '扬州市'],
    '浙江省': ['杭州市', '宁波市', '温州市', '嘉兴市', '湖州市', '绍兴市', '金华市', '衢州市', '舟山市', '台州市'],
    '山东省': ['济南市', '青岛市', '淄博市', '枣庄市', '东营市', '烟台市', '潍坊市', '济宁市', '泰安市', '威海市'],
    '河南省': ['郑州市', '开封市', '洛阳市', '平顶山市', '安阳市', '鹤壁市', '新乡市', '焦作市', '濮阳市', '许昌市'],
    '湖北省': ['武汉市', '黄石市', '十堰市', '宜昌市', '襄阳市', '鄂州市', '荆门市', '孝感市', '荆州市', '黄冈市'],
    '四川省': ['成都市', '自贡市', '攀枝花市', '泸州市', '德阳市', '绵阳市', '广元市', '遂宁市', '内江市', '乐山市'],
    '湖南省': ['长沙市', '株洲市', '湘潭市', '衡阳市', '邵阳市', '岳阳市', '常德市', '张家界市', '益阳市', '郴州市'],
    '河北省': ['石家庄市', '唐山市', '秦皇岛市', '邯郸市', '邢台市', '保定市', '张家口市', '承德市', '沧州市', '廊坊市'],
    '福建省': ['福州市', '厦门市', '莆田市', '三明市', '泉州市', '漳州市', '南平市', '龙岩市', '宁德市'],
    '陕西省': ['西安市', '铜川市', '宝鸡市', '咸阳市', '渭南市', '延安市', '汉中市', '榆林市', '安康市', '商洛市'],
    '辽宁省': ['沈阳市', '大连市', '鞍山市', '抚顺市', '本溪市', '丹东市', '锦州市', '营口市', '阜新市', '辽阳市'],
    '安徽省': ['合肥市', '芜湖市', '蚌埠市', '淮南市', '马鞍山市', '淮北市', '铜陵市', '安庆市', '黄山市', '滁州市'],
    '重庆市': ['渝中区', '江北区', '南岸区', '九龙坡区', '大渡口区', '沙坪坝区', '渝北区', '巴南区', '北碚区', '万州区'],
    '江西省': ['南昌市', '景德镇市', '萍乡市', '九江市', '新余市', '鹰潭市', '赣州市', '吉安市', '宜春市', '抚州市'],
    '天津市': ['和平区', '河东区', '河西区', '南开区', '河北区', '红桥区', '东丽区', '西青区', '津南区', '北辰区'],
    '广西壮族自治区': ['南宁市', '柳州市', '桂林市', '梧州市', '北海市', '防城港市', '钦州市', '贵港市', '玉林市', '百色市'],
    '云南省': ['昆明市', '曲靖市', '玉溪市', '保山市', '昭通市', '丽江市', '普洱市', '临沧市', '楚雄市', '红河市'],
    '贵州省': ['贵阳市', '六盘水市', '遵义市', '安顺市', '毕节市', '铜仁市', '黔西南市', '黔东南市', '黔南市'],
    '山西省': ['太原市', '大同市', '阳泉市', '长治市', '晋城市', '朔州市', '晋中市', '运城市', '忻州市', '临汾市'],
    '吉林省': ['长春市', '吉林市', '四平市', '辽源市', '通化市', '白山市', '松原市', '白城市', '延边市'],
    '黑龙江省': ['哈尔滨市', '齐齐哈尔市', '鸡西市', '鹤岗市', '双鸭山市', '大庆市', '伊春市', '佳木斯市', '七台河市', '牡丹江市'],
    '新疆维吾尔自治区': ['乌鲁木齐市', '克拉玛依市', '吐鲁番市', '哈密市', '昌吉市', '博尔塔拉市', '巴音郭楞市', '阿克苏市', '克孜勒苏市', '喀什市'],
    '甘肃省': ['兰州市', '嘉峪关市', '金昌市', '白银市', '天水市', '武威市', '张掖市', '平凉市', '酒泉市', '庆阳市'],
    '海南省': ['海口市', '三亚市', '三沙市', '儋州市', '五指山市', '琼海市', '文昌市', '万宁市', '东方市'],
    '宁夏回族自治区': ['银川市', '石嘴山市', '吴忠市', '固原市', '中卫市'],
    '青海省': ['西宁市', '海东市', '海北市', '黄南市', '海南市', '果洛市', '玉树市', '海西市'],
    '西藏自治区': ['拉萨市', '昌都市', '林芝市', '山南市', '那曲市', '阿里市', '日喀则市']
}

# 街道名称
streets = ['建国路', '人民路', '中山路', '解放路', '和平路', '胜利路', '光明路', '友谊路', '团结路', '民主路', '自由路', '新华路', '东风路', '红旗路', '朝阳路', '文化路', '科技路', '工业路', '商业路', '金融路', '教育路', '体育路', '健康路', '幸福路', '繁荣路', '复兴路', '发展路', '进步路', '创新路', '创业路']

# 手机号码格式（包括正确和错误的格式）
phone_formats = [
    lambda: f"{random.choice(['138', '139', '150', '151', '152', '153', '155', '156', '157', '158', '159', '186', '187', '188', '189'])}{random.randint(10000000, 99999999)}",  # 正确格式
    lambda: f"{random.choice(['138', '139', '150', '151', '152', '153', '155', '156', '157', '158', '159', '186', '187', '188', '189'])}-{random.randint(1000, 9999)}-{random.randint(1000, 9999)}",  # 带横线
    lambda: f"{random.choice(['138', '139', '150', '151', '152', '153', '155', '156', '157', '158', '159', '186', '187', '188', '189'])} {random.randint(1000, 9999)} {random.randint(1000, 9999)}",  # 带空格
    lambda: f"{random.choice(['138', '139', '150', '151', '152', '153', '155', '156', '157', '158', '159', '186', '187', '188', '189'])}-{random.randint(100, 999)}-{random.randint(10000, 99999)}",  # 错误的横线位置
    lambda: f"{random.choice(['138', '139', '150', '151', '152', '153', '155', '156', '157', '158', '159', '186', '187', '188', '189'])}{random.randint(1000000, 9999999)}",  # 少一位
    lambda: f"{random.choice(['138', '139', '150', '151', '152', '153', '155', '156', '157', '158', '159', '186', '187', '188', '189'])}{random.randint(100000000, 999999999)}",  # 多一位
    lambda: f"{random.choice(['138', '139', '150', '151', '152', '153', '155', '156', '157', '158', '159', '186', '187', '188', '189'])}-{random.randint(100, 999)}-{random.randint(100, 999)}-{random.randint(1000, 9999)}",  # 多个横线
]

# 日期格式（包括正确和错误的格式）
def generate_date():
    base_date = datetime(2023, 1, 1)
    random_days = random.randint(0, 364)
    target_date = base_date + timedelta(days=random_days)
    
    formats = [
        lambda d: d.strftime("%Y/%m/%d"),  # 2023/01/15
        lambda d: d.strftime("%Y-%m-%d"),  # 2023-01-15
        lambda d: d.strftime("%Y年%m月%d日"),  # 2023年01月15日
        lambda d: d.strftime("%y/%m/%d"),  # 23/01/15
        lambda d: d.strftime("%y-%m-%d"),  # 23-01-15
        lambda d: d.strftime("%Y.%m.%d"),  # 2023.01.15
        lambda d: d.strftime("%Y/%m/%d").replace("0", ""),  # 2023/1/15 (错误格式)
        lambda d: f"{d.year}/{random.randint(1,12)}/{random.randint(1,31)}",  # 随机日期（可能错误）
        lambda d: f"{d.year}-{random.randint(1,12)}-{random.randint(1,31)}",  # 随机日期（可能错误）
        lambda d: f"{d.year}年{random.randint(1,12)}月{random.randint(1,31)}日",  # 随机日期（可能错误）
    ]
    
    return random.choice(formats)(target_date)

# 生成姓名
def generate_name():
    surname = random.choice(surnames)
    name_length = random.choice([1, 2])
    if name_length == 1:
        name = random.choice(names)
    else:
        name = random.choice(names) + random.choice(names)
    return surname + name

# 生成地址
def generate_address():
    province = random.choice(provinces)
    city_list = cities.get(province, ['市区'])
    city = random.choice(city_list)
    street = random.choice(streets)
    number = random.randint(1, 999)
    
    # 有时生成不完整的地址
    if random.random() < 0.1:  # 10% 概率生成不完整地址
        incomplete_options = [
            f"{province}",  # 只有省份
            f"{city}",  # 只有城市
            f"{street}{number}号",  # 只有街道
            f"{province}{city}",  # 省份+城市
            f"{street}",  # 只有街道名
        ]
        return random.choice(incomplete_options)
    
    return f"{province}{city}{street}{number}号"

# 生成手机号码
def generate_phone():
    return random.choice(phone_formats)()

# 生成日期
def generate_date():
    base_date = datetime(2023, 1, 1)
    random_days = random.randint(0, 364)
    target_date = base_date + timedelta(days=random_days)
    
    formats = [
        lambda d: d.strftime("%Y/%m/%d"),  # 2023/01/15
        lambda d: d.strftime("%Y-%m-%d"),  # 2023-01-15
        lambda d: d.strftime("%Y年%m月%d日"),  # 2023年01月15日
        lambda d: d.strftime("%y/%m/%d"),  # 23/01/15
        lambda d: d.strftime("%y-%m-%d"),  # 23-01-15
        lambda d: d.strftime("%Y.%m.%d"),  # 2023.01.15
        lambda d: d.strftime("%Y/%m/%d").replace("0", ""),  # 2023/1/15 (错误格式)
        lambda d: f"{d.year}/{random.randint(1,12)}/{random.randint(1,31)}",  # 随机日期（可能错误）
        lambda d: f"{d.year}-{random.randint(1,12)}-{random.randint(1,31)}",  # 随机日期（可能错误）
        lambda d: f"{d.year}年{random.randint(1,12)}月{random.randint(1,31)}日",  # 随机日期（可能错误）
    ]
    
    return random.choice(formats)(target_date)

# 生成100万条数据
total_rows = 1000000  # 100万条

print(f"开始生成测试数据文件...")
print(f"目标行数: {total_rows:,} 行")

output_file = 'testdoc/large_test_data.csv'

start_time = time.time()

with open(output_file, 'w', newline='', encoding='utf-8-sig') as csvfile:
    writer = csv.writer(csvfile)
    
    # 写入表头
    writer.writerow(['姓名', '手机号码', '地址', '入职日期'])
    
    # 生成数据行
    for i in range(total_rows):
        name = generate_name()
        phone = generate_phone()
        address = generate_address()
        date = generate_date()
        
        writer.writerow([name, phone, address, date])
        
        # 每 10000 行显示一次进度
        if (i + 1) % 10000 == 0:
            elapsed = time.time() - start_time
            progress = (i + 1) / total_rows * 100
            print(f"已生成 {i + 1:,} 行 ({progress:.1f}%), 耗时 {elapsed:.1f} 秒")

end_time = time.time()
total_elapsed = end_time - start_time

# 获取文件实际大小
import os
file_size = os.path.getsize(output_file)
file_size_mb = file_size / (1024 * 1024)

print(f"\n✓ 文件生成完成！")
print(f"  文件路径: {output_file}")
print(f"  文件大小: {file_size_mb:.2f} MB ({file_size:,} 字节)")
print(f"  总行数: {total_rows:,} 行")
print(f"  总耗时: {total_elapsed:.2f} 秒")
print(f"  平均速度: {total_rows / total_elapsed:,.0f} 行/秒")
