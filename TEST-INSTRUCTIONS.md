# 测试指令

## 当前状态
- 后端服务已启动 (端口 3100)
- 代码修复已就位
- 测试文件: `testdoc/dirty_test_data.csv`

## 测试步骤

### 1. 上传测试文件
通过前端或API上传 `testdoc/dirty_test_data.csv` 文件

### 2. 查看后端日志
后端日志应该显示:
- 列类型识别结果
- 每行的清洗过程
- 错误数量

### 3. 检查数据库
运行以下命令查看数据库中的实际数据:

```bash
cd data-cleaning-service
npx ts-node ../check-database.ts
```

## 预期结果

测试文件包含 15 行数据,其中:
- **手机号错误** (5行): 
  - 行2: `138-1234-5678` (10位数字)
  - 行5: `139-123-45678` (12位数字)
  - 行8: `1391234567890` (13位数字)
  - 行10: `139-1234-567` (10位数字)
  - 行11: `13912345` (8位数字)

- **日期错误** (2行):
  - 行4: `23/08/15` (2位年份)
  - 行10: `23-07-20` (2位年份)

- **地址错误** (2行):
  - 行13: `广东省广州市` (不完整)
  - 行14: `东路800号` (不完整)

**预期异常行数: 7-9 行** (有些行有多个错误)

## 如果仍然显示 0 异常行

可能的原因:
1. 后端服务没有重新加载代码 (需要重启)
2. 数据库中有旧数据干扰
3. 日志级别设置为 ERROR,看不到 DEBUG 日志

### 解决方案

#### 方案1: 完全重启后端
```bash
# 停止当前进程
# 然后重新启动
cd data-cleaning-service
npm run start:dev
```

#### 方案2: 清空数据库
```sql
DELETE FROM error_log;
DELETE FROM clean_data;
DELETE FROM file_record;
```

#### 方案3: 启用 DEBUG 日志
修改 `data-cleaning-service/.env`:
```
LOG_LEVEL=debug
```
